<!DOCTYPE html> <html> <head> <meta http-equiv="Content-Type" content="text/html; charset=UTF-8"> <meta charset="utf-8"> <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"> <meta http-equiv="X-UA-Compatible" content="IE=edge"> <title> 集中不等式 | Zhonglin Xie </title> <meta name="author" content="Zhonglin Xie"> <meta name="description" content="an example of a distill-style blog post and main elements"> <link rel="stylesheet" href="/assets/css/bootstrap.min.css?a4b3f509e79c54a512b890d73235ef04"> <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/mdbootstrap@4.20.0/css/mdb.min.css" integrity="sha256-jpjYvU3G3N6nrrBwXJoVEYI/0zw8htfFnhT9ljN3JJw=" crossorigin="anonymous"> <link defer rel="stylesheet" href="/assets/css/academicons.min.css?f0b7046b84e425c55f3463ac249818f5"> <link defer rel="stylesheet" type="text/css" href="https://fonts.googleapis.com/css?family=Roboto:300,400,500,700|Roboto+Slab:100,300,400,500,700|Material+Icons&amp;display=swap"> <link defer rel="stylesheet" href="/assets/css/jekyll-pygments-themes-github.css?591dab5a4e56573bf4ef7fd332894c99" media="" id="highlight_theme_light"> <link rel="shortcut icon" href="data:image/svg+xml,&lt;svg%20xmlns=%22http://www.w3.org/2000/svg%22%20viewBox=%220%200%20100%20100%22&gt;&lt;text%20y=%22.9em%22%20font-size=%2290%22&gt;%F0%9F%8E%93&lt;/text&gt;&lt;/svg&gt;"> <link rel="stylesheet" href="/assets/css/main.css?d41d8cd98f00b204e9800998ecf8427e"> <link rel="canonical" href="https://zhonglinxie.github.io/blog/2021/%E9%9B%86%E4%B8%AD%E4%B8%8D%E7%AD%89%E5%BC%8F/"> <script src="/assets/js/theme.js?9a0c749ec5240d9cda97bc72359a72c0"></script> <link defer rel="stylesheet" href="/assets/css/jekyll-pygments-themes-native.css?5847e5ed4a4568527aa6cfab446049ca" media="none" id="highlight_theme_dark"> <script>initTheme();</script> <script defer src="https://cdn.jsdelivr.net/npm/medium-zoom@1.1.0/dist/medium-zoom.min.js" integrity="sha256-ZgMyDAIYDYGxbcpJcfUnYwNevG/xi9OHKaR/8GK+jWc=" crossorigin="anonymous"></script> <script defer src="/assets/js/zoom.js?85ddb88934d28b74e78031fd54cf8308"></script> <script src="https://cdn.jsdelivr.net/npm/jquery@3.6.0/dist/jquery.min.js" integrity="sha256-/xUj+3OJU5yExlq6GSYGSHk7tPXikynS7ogEvDej/m4=" crossorigin="anonymous"></script> <script type="text/javascript">window.MathJax={tex:{tags:"ams"}};</script> <script defer type="text/javascript" id="MathJax-script" src="https://cdn.jsdelivr.net/npm/mathjax@3.2.0/es5/tex-mml-chtml.min.js" integrity="sha256-rjmgmaB99riUNcdlrDtcAiwtLIojSxNyUFdl+Qh+rB4=" crossorigin="anonymous"></script> <script defer src="https://cdnjs.cloudflare.com/polyfill/v3/polyfill.min.js?features=es6" crossorigin="anonymous"></script> <script src="/assets/js/distillpub/template.v2.js"></script> <script src="/assets/js/distillpub/transforms.v2.js"></script> <script src="/assets/js/distillpub/overrides.js"></script> <style type="text/css">.fake-img{background:#bbb;border:1px solid rgba(0,0,0,0.1);box-shadow:0 0 4px rgba(0,0,0,0.1);margin-bottom:12px}.fake-img p{font-family:monospace;color:white;text-align:left;margin:12px 0;text-align:center;font-size:16px}</style> </head> <body> <d-front-matter> <script async type="text/json">
      {
            "title": "集中不等式",
            "description": "an example of a distill-style blog post and main elements",
            "published": "October 21, 2021",
            "authors": [
              
              {
                "author": "Zhonglin Xie",
                "authorURL": "https://zhonglinxie.github.io",
                "affiliations": [
                  {
                    "name": "BICMR, Beijing",
                    "url": ""
                  }
                ]
              }
              
            ],
            "katex": {
              "delimiters": [
                {
                  "left": "$",
                  "right": "$",
                  "display": false
                },
                {
                  "left": "$$",
                  "right": "$$",
                  "display": true
                }
              ]
            }
          }
    </script> </d-front-matter> <header> <nav id="navbar" class="navbar navbar-light navbar-expand-sm fixed-top" role="navigation"> <div class="container"> <a class="navbar-brand title font-weight-lighter" href="/"> Zhonglin Xie </a> <button class="navbar-toggler collapsed ml-auto" type="button" data-toggle="collapse" data-target="#navbarNav" aria-controls="navbarNav" aria-expanded="false" aria-label="Toggle navigation"> <span class="sr-only">Toggle navigation</span> <span class="icon-bar top-bar"></span> <span class="icon-bar middle-bar"></span> <span class="icon-bar bottom-bar"></span> </button> <div class="collapse navbar-collapse text-right" id="navbarNav"> <ul class="navbar-nav ml-auto flex-nowrap"> <li class="nav-item "> <a class="nav-link" href="/">About </a> </li> <li class="nav-item "> <a class="nav-link" href="/publications/">Publications </a> </li> <li class="nav-item "> <a class="nav-link" href="/talks/">Talks </a> </li> <li class="nav-item "> <a class="nav-link" href="/teaching/">Teaching </a> </li> <li class="nav-item "> <a class="nav-link" href="/cv/">CV </a> </li> <li class="nav-item "> <a class="nav-link" href="/news/">News </a> </li> <li class="nav-item "> <a class="nav-link" href="/blog/">Blog </a> </li> <li class="toggle-container"> <button id="light-toggle" title="Change theme"> <i class="ti ti-sun-moon" id="light-toggle-system"></i> <i class="ti ti-moon-filled" id="light-toggle-dark"></i> <i class="ti ti-sun-filled" id="light-toggle-light"></i> </button> </li> </ul> </div> </div> </nav> <progress id="progress" value="0"> <div class="progress-container"> <span class="progress-bar"></span> </div> </progress> </header> <div class="post distill"> <d-title> <h1>集中不等式</h1> <p>an example of a distill-style blog post and main elements</p> </d-title> <d-byline></d-byline> <d-article> <d-contents> <nav class="l-text figcaption"> <h3>Contents</h3> <div> <a href="#equations">Equations</a> </div> <div> <a href="#citations">Citations</a> </div> <div> <a href="#footnotes">Footnotes</a> </div> <div> <a href="#code-blocks">Code Blocks</a> </div> <div> <a href="#interactive-plots">Interactive Plots</a> </div> <div> <a href="#layouts">Layouts</a> </div> <div> <a href="#other-typography">Other Typography?</a> </div> </nav> </d-contents> <p>最近在上的两门课都频繁地用到了集中不等式, 遂作文以总结之, 主要材料来自《Foundations of Machine Learning》的附录 D 与《High-Dimensional Probability: An Introduction with Applications in Data Science》的第二章.</p> <h2 id="markovs-inequality-与-chernoff-bounding-technique">Markov’s Inequality 与 Chernoff Bounding Technique</h2> <p>最经典的集中不等式当属 Markov’s Inequality, 其证明技巧被广泛应用于其他不等式. 考虑一个非负的随机变量 $X$, 则对每一个 $\varepsilon&gt;0$, $\varepsilon\mathbb{P}[X\geqslant \varepsilon] \leqslant \mathbb{E}X$, 这就是 Markov’s Inequality:</p> <blockquote> <p>设随机变量 $X\geqslant 0$, 则 $\forall \varepsilon &gt;0$,</p> <p>$\mathbb{P}[X\geqslant \varepsilon] \leqslant \frac{1}{\varepsilon} \mathbb{E}X.$</p> </blockquote> <p>注意到 $e^{t\varepsilon}&gt;0,\,\mathbb{P}[X\geqslant \varepsilon]=\mathbb{P}[e^{tX}\geqslant e^{t\varepsilon}]$, 于是</p> <p>$\mathbb{P}[X\geqslant \varepsilon]\leqslant e^{-t\varepsilon}\mathbb{P}[e^{tX}\geqslant e^{t\varepsilon}].$</p> <p>我们可以通过对 $\mathbb{P}[e^{tX}\geqslant e^{t\varepsilon}]$ 进行放缩, 得到关于 $t$ 的函数, 再对 $t$ 求最小值来给出 $\mathbb{P}[X\geqslant \varepsilon]$ 的估计, 这种技巧称为 Chernoff Bounding Technique.</p> <h2 id="hoeffdings-inequality">Hoeffding’s Inequality</h2> <p>Hoeffding’s Inequality 的证明依赖于 Hoeffding’s Lemma.</p> <blockquote> <p>设 $X$ 是在区间 $[a,b]$ 中取值且 $\mathbb{E}X=0$ 的随机变量, 则对每一个 $t&gt;0$, 有</p> <p>$\mathbb{E}\exp(tX) \leqslant \exp\left(\frac{t^2(b-a)^2}{8}\right).$</p> </blockquote> <p>证明: 将 $\exp(tX)$ 视为 $X$ 的函数, 利用凸性得到</p> <p>$\exp(tX)\leqslant \frac{X-a}{b-a}\exp\left(tb\right) + \frac{b-X}{b-a}\exp\left(ta\right).$</p> <p>由于 $\mathbb{E}X=0$, 于是</p> <p>$\mathbb{E}\exp(tX) \leqslant \frac{b}{b-a}\mathbb{E}\exp\left(ta\right) - \frac{a}{b-a}\mathbb{E}\exp\left(tb\right).$</p> <p>定义</p> <p>$\varphi(t)=\log\left(\frac{b}{b-a}\exp\left(ta\right) - \frac{a}{b-a}\exp\left(tb\right)\right).$</p> <p>则 $\varphi(0)=0,\,\varphi’(0)=0,$ 而</p> <p>$\begin{aligned} \varphi’’(\xi)&amp;=\frac{ab(ae^{\xi a}-be^{\xi b})(be^{\xi a}-ae^{\xi b})-a^2b^2(e^{\xi a}-e^{\xi b})^2}{(be^{\xi a}-ae^{\xi b})^2}<br> &amp;=\frac{-ab(b-a)^2}{-2ab+a^2e^{\xi (a-b)}+b^2e^{\xi (b-a)}}<br> &amp;\leqslant \frac{(b-a)^2}{4}. \end{aligned}$</p> <p>利用带 Lagrange 余项的展开得, 存在 $\xi\in(0,t)$</p> <p>$\varphi(t) = \varphi(0) + \varphi’(0)t + \frac{\varphi’’(\xi)}{2} t^2\leqslant \frac{t^2(b-a)^2}{8}.$</p> <p>故</p> <p>$\mathbb{E}\exp(tX) \leqslant \mathbb{E} e^{\varphi(t)} \leqslant \exp\left(\frac{t^2(b-a)^2}{8}\right).$</p> <blockquote> <p>假设 $X_i\in [a_i,b_i],\,i=1,2,\ldots,m$ 是一组相互独立的随机变量, 记 $S=\sum_{i=1}^m X_i$, 则 $\forall \varepsilon &gt; 0$,</p> <p>$\begin{aligned} \mathbb{P}[S - \mathbb{E}S\geqslant \varepsilon]&amp;\leqslant \exp\left(-\frac{2\varepsilon^2}{\sum_{i=1}^{m} (b_i-a_i)^{2}}\right),<br> \mathbb{P}[S - \mathbb{E}S\leqslant -\varepsilon]&amp;\leqslant \exp\left(-\frac{2\varepsilon^2}{\sum_{i=1}^{m} (b_i-a_i)^{2}}\right). \end{aligned}$</p> </blockquote> <p>证明: 由 Markov’s Inequality 及 $X_i$ 的独立性, 任取 $t&gt;0$</p> <p>$\begin{aligned} \mathbb{P}[S - \mathbb{E}S\geqslant \varepsilon]&amp;\leqslant e^{-t\varepsilon}\mathbb{E}\exp\left(t(S - \mathbb{E}S)\right)<br> &amp;= e^{-t\varepsilon} \prod_{i=1}^m \mathbb{E}\exp\left(t(X_i-\mathbb{E}X_i)\right)<br> &amp;\leqslant \exp\left(-t\varepsilon + \frac{t^2}{8}\sum_{i=1}^m(b_i-a_i)^2 \right). \end{aligned}$</p> <p>取 $t=\frac{4\varepsilon}{\sum_{i=1}^m(b_i-a_i)^2}$ 得</p> <p>$\mathbb{P}[S - \mathbb{E}S\geqslant \varepsilon]\leqslant \exp\left(-\frac{2\varepsilon^2}{\sum_{i=1}^{m} (b_i-a_i)^{2}}\right).$</p> <p>对 $-X_i$ 使用上述不等式即得</p> <p>$\mathbb{P}[S - \mathbb{E}S\leqslant -\varepsilon]\leqslant \exp\left(-\frac{2\varepsilon^2}{\sum_{i=1}^{m} (b_i-a_i)^{2}}\right).$</p> <p>相比于粗糙的 Union Bound, 即 $\mathbb{P}(\cup A_i)\leqslant \cup \mathbb{P}A_i$, Hoeffding’s Inequality 往往能给出精确地多的估计 (不等式右端以指数平方衰减), 但 Hoeffding’s Inequality 并没有考虑随机变量 $X_i$ 在区间 $[a_i,b_i]$ 内的分布情况, 当 $X_i$ 的期望 $p_i$ 已知时, 我们希望得到更精确的估计, 这就是 Multiplicative Chernoff Bounds 要做的. 为导出 Multiplicative Chernoff Bounds, 我们先证明 Sanov’s Theorem.</p> <h2 id="sanovs-theorem-chernoffhoeffding-theorem">Sanov’s Theorem (Chernoff–Hoeffding Theorem)</h2> <blockquote> <p>假设 $X_1,\ldots,X_m$ 是相互独立且服从分布 $\mathcal{D}$ 的随机变量, 它们在区间 $[0,1]$ 内取值, 且均值为 $p$. 则对每一个 $q\in [p,1]$, 有</p> <p>$\mathbb{P}\left[\frac{1}{m} \sum_{i=1}^{m} X_{i}\geqslant q\right] \leqslant \exp\big(-mD(q\parallel p)\big),$</p> <p>其中</p> <p>$D(q\parallel p) = q \log \frac{q}{p}+(1-q) \log \frac{1-q}{1-p}$</p> <p>称为 $q$ 关于 $p$ 的二元相对熵 (Binary Relative Entropy).</p> </blockquote> <p>证明: 对每一个 $t &gt; 0$, 借助 Markov’s Inequality 证明中的技巧得</p> <p>$\begin{aligned} \mathbb{P}\left[\frac{1}{m} \sum_{i=1}^{m} X_{i}\geqslant q\right] =&amp; e^{-tmq}e^{tmq}\mathbb{P}\left[\exp\Big(t \sum_{i=1}^{m} X_{i}\Big)\geqslant e^{tmq}\right]<br> \leqslant&amp; e^{-tmq}\mathbb{E}\left[\exp\Big(t \sum_{i=1}^{m} X_{i}\Big)\right]<br> =&amp; e^{-tmq}\prod_{i=1}^{m}\mathbb{E}\left[\exp(t X_{i})\right]. \end{aligned}$</p> <p>将 $\exp(t X_{i})$ 视为关于 $X_i$ 的凸函数, 由于 $X_i\in [0,1]$, 则</p> <p>$\exp(t X_{i}) \leqslant (1-X_i) \exp(t \cdot 0)+X_i\exp(t\cdot 1)=(1-X_i)+X_i\exp(t).$</p> <p>因此</p> <p>$\mathbb{E}\exp(t X_{i}) \leqslant 1-p + pe^{t}.$</p> <p>故 $\forall t&gt;0$, 有</p> <p>$\mathbb{P}\left[\frac{1}{m} \sum_{i=1}^{m} X_{i}\geqslant q\right] \leqslant e^{-tmq}(1-p + pe^{t})^m = \big( (1-p)e^{-tq}+pe^{(1-q)t}\big)^m.$</p> <p>$(1-p)e^{-tq}+pe^{(1-q)t}$ 在 $t=\log\frac{q(1-p)}{p(1-q)}$ 处取最小值. 在 $p&lt;q$ 时, 令 $t=\log\frac{q(1-p)}{p(1-q)}&gt;0$ 得</p> <p>$\begin{aligned} \mathbb{P}\left[\frac{1}{m} \sum_{i=1}^{m} X_{i}\geqslant q\right] &amp;\leqslant \left((1-p)\left(\frac{p(1-q)}{q(1-p)}\right)^q+p\left(\frac{q(1-p)}{p(1-q)}\right)^{1-q}\right)^m<br> &amp;=\left(\left(\frac{p(1-q)}{q(1-p)}\right)^q \left(1-p+p\frac{q(1-p)}{p(1-q)}\right) \right)^m<br> &amp;=\left(\left(\frac{p(1-q)}{q(1-p)}\right)^q \left(\frac{1-p}{1-q}\right) \right)^m<br> &amp;=\exp(-mD(q\parallel p)). \end{aligned}$</p> <p>在 $q=p$ 时, $D(q\parallel p)=0$, 此时欲证的概率不等式右端为 $1$, 必然成立.</p> <p>利用 Sanov’s Theorem 可以得到比 Hoeffding’s Inequality 更好的估计, 取 $0&lt;\varepsilon\leqslant 1-p$, 则 $p+\varepsilon \in (p, 1]$, 于是</p> <p>$\mathbb{P}\left[\frac{1}{m} \sum_{i=1}^{m} X_{i}\geqslant p+\varepsilon\right] \leqslant \exp(-mD(p+\varepsilon\parallel p)).$</p> <p>考虑函数</p> <p>$f(p) = q \log \frac{q}{p}+(1-q) \log \frac{1-q}{1-p} - 2(p-q)^2,\quad p\in [0,1].$</p> <p>其导数为</p> <p>$f’(p) = -\frac{q}{p} + \frac{1-q}{1-p} - 4(p-q) = (p-q)\left(\frac{1}{p(1-p)}-4\right).$</p> <p>由 $p(1-p)\leqslant 1/4$ 知 $p=q$ 是 $f(p)$ 的最小值点, 故 $f(p)\geqslant f(q) = 0$, 因此</p> <p>$D(q\parallel p) = q \log \frac{q}{p}+(1-q) \log \frac{1-q}{1-p}\geqslant 2(p-q)^2,$</p> <p>该不等式称为 Pinsker’s Inequality. 取 $q=p+\varepsilon$ 得</p> <p>$D(p+\varepsilon\parallel p) \geqslant 2\varepsilon^2 \quad \Rightarrow \quad \exp(-mD(p+\varepsilon\parallel p))\leqslant \exp(-2m\varepsilon^2).$</p> <p>这说明利用 Sanov’s Theorem 得到的估计不弱于利用 Hoeffding’s Inequality 得到的估计. 对另一方向的概率</p> <p>$\mathbb{P}\left[\frac{1}{m} \sum_{i=1}^{m} X_{i}\leqslant p-\varepsilon\right]$</p> <p>进行估计时, 仅需构造 $Y_i = 1-X_i$, 则 $Y_i\in [0,1],\,\mathbb{E}Y_i=1-p$, 于是</p> <p>$\mathbb{P}\left[\frac{1}{m} \sum_{i=1}^{m} X_{i}\leqslant p-\varepsilon\right] = \mathbb{P}\left[\frac{1}{m} \sum_{i=1}^{m} Y_{i}\geqslant 1-p+\varepsilon\right]\leqslant \exp(-mD(1-p+\varepsilon\parallel 1-p))=\exp(-mD(p-\varepsilon\parallel p)).$</p> <p>最后一个等式利用了二元相对熵的性质: $D(1-p+\varepsilon\parallel 1-p) = D(p-\varepsilon\parallel p)$.</p> <h2 id="multiplicative-chernoff-bounds">Multiplicative Chernoff Bounds</h2> <blockquote> <p>假设 $X_1,\ldots,X_m$ 是相互独立且服从分布 $\mathcal{D}$ 的随机变量, 它们在区间 $[0,1]$ 内取值, 且均值为 $p$. 则对每一个 $\gamma \in [0,\frac{1}{p}-1]$, 有</p> <p>$\begin{aligned} \mathbb{P}\left[\frac{1}{m} \sum_{i=1}^{m} X_{i}\geqslant (1+\gamma)p\right] &amp;\leqslant \exp\big(-\frac{mp\gamma^2}{\gamma+2}\big),<br> \mathbb{P}\left[\frac{1}{m} \sum_{i=1}^{m} X_{i}\leqslant (1-\gamma)p\right] &amp;\leqslant \exp\big(-\frac{mp\gamma^2}{2}\big). \end{aligned}$</p> </blockquote> <p>证明: 上述结果的证明需要对二元相对熵 $D(q\parallel p)$ 进行比 Pinsker’s Inequality 更加精确的估计, 首先要用到两个不等式:</p> <p>$\log(1+x) \geqslant \frac{x}{1+x/2},\quad \log(1+x)\leqslant x.$</p> <p>由于 $\mathbb{P}\left[\frac{1}{m} \sum_{i=1}^{m} X_{i}\geqslant (1+\gamma)p\right]\leqslant \exp\big(-m D((1+\gamma)p\parallel p)\big)$, 仅需估计 $D((1+\gamma)p\parallel p)$.</p> <p>$\begin{aligned} D((1+\gamma)p\parallel p)&amp;=(1+\gamma) p \log \frac{(1+\gamma) p}{p}+(1-(1+\gamma) p) \log \left[\frac{1-(1+\gamma) p}{1-p}\right] <br> &amp;=(1+\gamma) p \log (1+\gamma)+(1-p-\gamma p) \log \left[1-\frac{\gamma p}{1-p}\right] <br> &amp;\geqslant(1+\gamma) p \frac{\gamma}{1+\frac{\gamma}{2}}-(1-p-\gamma p) \frac{\gamma p}{1-p}<br> &amp;=\gamma^2p\left(\frac{1}{\gamma+2}+\frac{1}{1/p-1}\right)<br> &amp;\geqslant \frac{\gamma^2p}{\gamma+2}. \end{aligned}$</p> <p>故 $\mathbb{P}\left[\frac{1}{m} \sum_{i=1}^{m} X_{i}\geqslant (1+\gamma)p\right]\leqslant \exp\big(-\frac{m\gamma^2p}{\gamma+2}\big)$. 再对 $D((1-\gamma)p\parallel p)$ 进行估计, 这需要用到</p> <p>$(1-x) \log (1-x) \geqslant -x+\frac{x^{2}}{2},\;x\in(0,1) ,\quad (1+x)\log(1+x)\geqslant x.$</p> <p>由于</p> <p>$\begin{aligned} D((1-\gamma)p\parallel p) &amp;= (1-\gamma)p\log \frac{(1-\gamma)p}{p} + (1-p+\gamma p)\log \frac{1-p+\gamma p}{1-p}<br> &amp;\geqslant p(-\gamma + \frac{\gamma^2}{2})+(1-p)\left(1 + \frac{\gamma p}{1-p}\right)\log\left(1 + \frac{\gamma p}{1-p}\right)<br> &amp;\geqslant p(-\gamma + \frac{\gamma^2}{2}) + (1-p)\frac{\gamma p}{1-p}<br> &amp;=\frac{\gamma^2p}{2}. \end{aligned}$</p> <p>故 $\mathbb{P}\left[\frac{1}{m} \sum_{i=1}^{m} X_{i}\leqslant (1-\gamma)p\right]\leqslant \exp\big(-\frac{m\gamma^2p}{2}\big)$.</p> <h2 id="azumas-inequality">Azuma’s Inequality</h2> <p>为证明 Azuma’s Inequality, 先定义鞅差序列 (Martingale Difference Sequence (MDS)):</p> <blockquote> <p>称一组随机变量序列 $V_1,V_2,\ldots$ 为关于 $X_1,X_2,\ldots$ 的鞅差序列, 若对每一个 $i&gt;0$, $V_i$ 是 $X_1,X_2,\ldots,X_{i}$ 的函数, 并且满足</p> <p>$\mathbb{E}\left[V_{i+1} \mid X_{1}, \ldots, X_{i}\right]=0.$</p> </blockquote> <p>回顾鞅 (Martingale) 的定义:</p> <blockquote> <p>称随机变量序列 $Y_1,Y_2,\ldots$ 为关于 $X_1,X_2,\ldots$ 的鞅, 若</p> <table> <tbody> <tr> <td>$\mathbb{E}</td> <td>Y_i</td> <td>&lt;\infty,\quad \mathbb{E}\left[Y_{i+1} \mid X_{1}, \ldots, X_{i}\right]=Y_i.$</td> </tr> </tbody> </table> </blockquote> <p>鞅差序列的定义实际上是在说</p> <p>$\mathbb{E}\left[\sum_{k=1}^{i+1} V_{k}\mid X_{1}, \ldots, X_{i}\right]=\sum_{k=1}^{i} V_{k}.$</p> <p>即以 $V_k$ 为增量的随机变量序列 $\sum_{k=1}^{i} V_{k}$ 是鞅.</p> <p>与 Hoeffding’s Inequality 的证明类似, Azuma’s Inequality 的证明也依赖于对单变量情形的分析:</p> <blockquote> <p>假设 $V,Z$ 是满足 $\mathbb{E}[V\mid Z]=0$ 的随机变量, 并且对某个函数 $f(\cdot)$ 与非负常数 $c\geqslant 0$ 有</p> <p>$f(Z) \leqslant V \leqslant f(Z)+c.$</p> <p>则任取 $t &gt; 0$, 有如下估计:</p> <p>$\mathbb{E}\left[e^{t V} \mid Z\right] \leq e^{t^{2} c^{2} / 8}.$</p> </blockquote> <p>证明: 将 Hoeffding’s Lemma 中的概率全部替换为关于变量 $Z$ 的条件概率即得.</p> <p>结合鞅差序列的定义与上述推广的 Hoeffding’s Lemma, 我们可以将 Hoeffding’s Inequality 推广到更加一般的情形:</p> <blockquote> <p>设 $V_1,V_2,\ldots$ 是关于随机变量 $X_1,X_2,\ldots$ 的鞅差序列. 且任取 $i&gt;0$, 存在常数 $c_i\geqslant 0$ 与以 $X_1,X_2,\ldots,X_{i-1}$ 为自变量的函数 $Z_i$, 使得</p> <p>$Z_i\leqslant V_i \leqslant Z_i+c_i.$</p> <p>则任取 $\varepsilon &gt; 0$ 与正整数 $m$, 有下列不等式成立:</p> <p>$\begin{aligned}\mathbb{P}\left[\sum_{i=1}^{m} V_{i} \geqslant \varepsilon\right] \leqslant \exp \left(\frac{-2 \varepsilon^{2}}{\sum_{i=1}^{m} c_{i}^{2}}\right), \\mathbb{P}\left[\sum_{i=1}^{m} V_{i}\leqslant-\varepsilon\right] \leqslant \exp \left(\frac{-2 \varepsilon^{2}}{\sum_{i=1}^{m} c_{i}^{2}}\right).\end{aligned}$</p> </blockquote> <p>证明: 记 $S_{k}=\sum_{i=1}^{k} V_{k}$, 于是任取 $t&gt;0$, 有</p> <p>$\begin{aligned} \mathbb{P}\left[S_{m} \geqslant \varepsilon\right] &amp; \leqslant e^{-t \varepsilon} \mathbb{E}\left[e^{t S_{m}}\right] <br> &amp;=e^{-t \varepsilon} \mathbb{E}\left[e^{t S_{m-1}} \mathbb{E}\left[e^{t \mathbf{V}<em>{m}} \mid X</em>{1}, \ldots, X_{m-1}\right]\right] <br> &amp; \leqslant e^{-t \varepsilon} \mathbb{E}\left[e^{t S_{m-1}}\right] e^{t^{2} c_{m}^{2} / 8} <br> &amp; \leqslant e^{-t \varepsilon} e^{t^{2} \sum_{i=1}^{m} c_{i}^{2} / 8} <br> &amp;=e^{-2 \varepsilon^{2} / \sum_{i=1}^{m} c_{i}^{2}}. \end{aligned}$</p> <p>其中第二步用到了重期望公式</p> <p>$\mathbb{E}\left[e^{t S_{m}}\right] = \mathbb{E}\left[e^{t S_{m-1}} \mathbb{E}\left[e^{t \mathbf{V}<em>{m}} \mid X</em>{1}, \ldots, X_{m-1}\right]\right],$</p> <p>最后一步是通过取 $t = \frac{4\varepsilon}{\sum_{i=1}^{m} c_{i}^{2}}$ 得到的.</p> <h2 id="mcdiarmids-inequality">McDiarmid’s Inequality</h2> <blockquote> <p>设 $X_1,X_2,\ldots,X_m$ 是一组相互独立且在 $\mathcal{X}$ 中取值的随机变量, 函数 $f\colon\mathcal{X}^m\to \mathbb{R}$ 满足</p> <table> <tbody> <tr> <td>$\left</td> <td>f\left(x_{1}, \ldots, x_{i}, \ldots, x_{m}\right)-f\left(x_{1}, \ldots, x_{i}^{\prime}, \ldots x_{m}\right)\right</td> <td>\leq c_{i},\quad \forall x_k\in\mathcal{X},\;x_i’\in\mathcal{X},\;k=1,2,\ldots,m,$</td> </tr> </tbody> </table> <p>其中 $c_1,c_2,\ldots,c_m$ 是一组大于 $0$ 的常数. 以 $f(S)$ 表示 $f(X_1,X_2,\ldots,X_m)$, 则任取 $\varepsilon &gt; 0$, 有</p> <p>$\begin{aligned} \mathbb{P}[f(S)-\mathbb{E}[f(S)] \geq \varepsilon] &amp; \leq \exp \left(\frac{-2 \varepsilon^{2}}{\sum_{i=1}^{m} c_{i}^{2}}\right), <br> \mathbb{P}[f(S)-\mathbb{E}[f(S)] \leq-\varepsilon] &amp; \leq \exp \left(\frac{-2 \varepsilon^{2}}{\sum_{i=1}^{m} c_{i}^{2}}\right). \end{aligned}$</p> </blockquote> <p>证明: 取</p> <p>$V_k = \mathbb{E}\left[f(S)\mid X_1,\ldots,X_{k-1}\right]-\mathbb{E}\left[f(S)\mid X_1,\ldots,X_{k}\right],\quad k=2,3,\ldots,m.$</p> <p>并规定 $V_1= f(S)-\mathbb{E}\left[f(S)\mid X_1\right]$. 可以验证这样定义的 $V_1,V_2,\ldots,V_m$ 是关于随机变量序列 $X_1,X_2,\ldots,X_m$ 的鞅差序列. 定义</p> <p>$\begin{aligned} U_{k} &amp;=\mathbb{E}\left[f(S) \mid X_{1}, \ldots, X_{k-1}\right] - \inf_{x} \mathbb{E}\left[f(S) \mid X_{1}, \ldots, X_{k-1}, x\right],<br> L_{k} &amp;=\mathbb{E}\left[f(S) \mid X_{1}, \ldots, X_{k-1}\right] - \sup_{x} \mathbb{E}\left[f(S) \mid X_{1}, \ldots, X_{k-1}, x\right]. \end{aligned}$</p> <p>它们分别是 $V_k$ 的上下确界, 利用条件</p> <table> <tbody> <tr> <td>$\left</td> <td>f\left(x_{1}, \ldots, x_{i}, \ldots, x_{m}\right)-f\left(x_{1}, \ldots, x_{i}^{\prime}, \ldots x_{m}\right)\right</td> <td>\leq c_{i},\quad \forall x_k\in\mathcal{X},\;x_i’\in\mathcal{X},\;k=1,2,\ldots,m,$</td> </tr> </tbody> </table> <p>得 $U_k\leqslant L_k + c_k$, 故</p> <p>$L_k \leqslant V_k \leqslant L_k+c_k.$</p> <p>再由 Sanov’s Theorem 即得</p> <p>$\mathbb{P}[f(S)-\mathbb{E}[f(S)] \geq \varepsilon] = \mathbb{P}\left[\sum_{i=1}^{m} V_{i} \geqslant \varepsilon\right] \leq \exp \left(\frac{-2 \varepsilon^{2}}{\sum_{i=1}^{m} c_{i}^{2}}\right).$</p> <p>同理可得</p> <p>$\mathbb{P}[f(S)-\mathbb{E}[f(S)] \leq-\varepsilon] \leq \exp \left(\frac{-2 \varepsilon^{2}}{\sum_{i=1}^{m} c_{i}^{2}}\right).$</p> <p>该不等式表明当自变量给函数 $f$ 带来的改变有界时, $f(S)$ 对均值的偏离可以被指数函数控制. Hoeffding’s Inequality 可通过取</p> <p>$f(S)=f(X_1,X_2,\ldots,X_m)=\frac{1}{m}\sum_{i=1}^m X_i$</p> <p>的 McDiarmid’s Inequality 得到.</p> <h2 id="次高斯-sub-gaussian-随机变量与-maximal-inequality">次高斯 (Sub-Gaussian) 随机变量与 Maximal Inequality</h2> <p>作为本文的结尾, 我们最后给出次高斯随机变量的定义及 Maximal Inequality. 服从高斯分布的随机变量的一个重要性质是其尾部以指数平方的概率衰减, 例如当变量 $X\sim \mathcal{N}(0,1)$, 对每个 $t\geqslant 0$, 有</p> <table> <tbody> <tr> <td>$\mathbb{P}[</td> <td>X</td> <td>\geqslant t]\leqslant 2e^{-t^2/2}.$</td> </tr> </tbody> </table> <p>这种形式的估计在实际推导中很有用, 是服从高斯分布的随机变量最重要的性质之一. 我们将这一性质推广, 并以此来定义次高斯随机变量.</p> <blockquote> <p>对随机变量 $X$, 若存在 $K_1&gt;0$, 使得</p> <table> <tbody> <tr> <td>$\mathbb{P}[</td> <td>X</td> <td>\geqslant t]\leqslant 2\exp\left(-t^2/K_1^2\right),\quad \forall t\geqslant 0.$</td> </tr> </tbody> </table> <p>则称其为次高斯随机变量.</p> </blockquote> <p>若 $\mathbb{E}X=0$, 其还具有如下的等价定义 (此处留坑, 以后有心情再补证明):</p> <blockquote> <p>存在 $K_5&gt;0$, 使得</p> <p>$\mathbb{E} \exp (\lambda X) \leq \exp \left(K_{5}^{2} \lambda^{2}\right), \quad \forall \lambda \in \mathbb{R}.$</p> </blockquote> <p>且在该不等式成立时, 必然有 $\mathbb{E}X=0.$ (继续留坑)</p> <p>借助这一等价定义, 可以对由有限个次高斯随机变量构成的集合的最大值进行估计.</p> <blockquote> <p>假设 $X_1,X_2,\ldots,X_n$ 是一组满足</p> <p>$\exp(tX_j)\leqslant \exp \left(\frac{r^2t^2}{2}\right),\quad j=1,2,\ldots,n$</p> <p>的次高斯随机变量 (不要求独立), 其中 $r&gt;0$. 则</p> <p>$\mathbb{E}\left[\max <em>{1\leqslant j\leqslant n} X</em>{j}\right] \leqslant r \sqrt{2 \log n}.$</p> </blockquote> <p>证明: 任取 $t&gt;0$, 利用指数函数的凸性及 Jensen’s Inequality 得</p> <p>$\exp\left(t \mathbb{E}\left[\max <em>{1\leqslant j\leqslant n} X</em>{j}\right]\right) \leqslant \mathbb{E}\exp\left(t \max <em>{1\leqslant j\leqslant n} X</em>{j}\right)=\mathbb{E}\left[\max <em>{1\leqslant j\leqslant n} \exp(tX_j)\right] \leqslant \mathbb{E}\left[\sum</em>{1\leqslant j\leqslant n} \exp(tX_j)\right] \leqslant \mathbb{E}\ n e^{\frac{t^{2} r^{2}}{2}}.$</p> <p>两边取对数并除以 $t$ 得</p> <p>$\mathbb{E}\left[\max <em>{1\leqslant j\leqslant n} X</em>{j}\right] \leqslant \frac{\log n}{t}+\frac{t r^{2}}{2}.$</p> <p>取 $t=\sqrt{2\log n}/r$ 即得</p> <p>$\mathbb{E}\left[\max <em>{1\leqslant j\leqslant n} X</em>{j}\right] \leqslant r \sqrt{2 \log n}.$</p> <p>该定理还有以下推论:</p> <blockquote> <p>假设 $X_1,\ldots,X_n$ 是满足 $X_j=\sum_{i=1}^mY_{ij}$ 的随机变量, $Y_{ij}$ 是相互独立的随机变量, 且 $Y_{ij}\in [-r_i,+r_i],\,r_i&gt;0,\,\mathbb{E}Y_{ij}=0$, 则</p> <p>$\mathbb{E}\left[\max <em>{1\leqslant j\leqslant n} X</em>{j}\right] \leqslant r \sqrt{2 \log n},\quad r=\sqrt{\sum_{i=1}^{m} r_{i}^{2}}.$</p> </blockquote> <p>证明: 只需证明 $\mathbb{E}\exp\left(tX_j\right)\leqslant \exp\left(r^2t^2/2\right)$, 其中 $r=\sqrt{\sum_{i=1}^{m} r_{i}^{2}}$. 利用 $Y_{ij}$ 的独立性及 Hoeffding’s Inequality, 有</p> <p>$\mathbb{E}\left[e^{t X_{j}}\right]=\mathbb{E}\left[\prod_{i=1}^{m} e^{t Y_{i j}}\right]=\prod_{i=1}^{m} \mathbb{E}\left[e^{t Y_{i j}}\right] \leqslant \prod_{i=1}^{m} e^{\frac{t^{2} r_{j}^{2}}{2}}=e^{\frac{t^{2} r^{2}}{2}}.$</p> <p>再由 Maximal Inequality 即得</p> <p>$\mathbb{E}\left[\max <em>{1\leqslant j\leqslant n} X</em>{j}\right] \leqslant r \sqrt{2 \log n},\quad r=\sqrt{\sum_{i=1}^{m} r_{i}^{2}}.$</p> </d-article> <d-appendix> <d-footnote-list></d-footnote-list> <d-citation-list></d-citation-list> </d-appendix> <d-bibliography src="/assets/bibliography/2018-12-22-distill.bib"></d-bibliography> <div id="giscus_thread" style="max-width: 930px; margin: 0 auto;"> <script>let giscusTheme=determineComputedTheme(),giscusAttributes={src:"https://giscus.app/client.js","data-repo":"zhonglinxie/zhonglinxie.github.io","data-repo-id":"","data-category":"Comments","data-category-id":"","data-mapping":"title","data-strict":"1","data-reactions-enabled":"1","data-emit-metadata":"0","data-input-position":"bottom","data-theme":giscusTheme,"data-lang":"en",crossorigin:"anonymous",async:""},giscusScript=document.createElement("script");Object.entries(giscusAttributes).forEach(([t,e])=>giscusScript.setAttribute(t,e)),document.getElementById("giscus_thread").appendChild(giscusScript);</script> <noscript>Please enable JavaScript to view the <a href="http://giscus.app/?ref_noscript" rel="external nofollow noopener" target="_blank">comments powered by giscus.</a> </noscript> </div> </div> <footer class="fixed-bottom" role="contentinfo"> <div class="container mt-0"> © Copyright 2024 Zhonglin Xie. Powered by <a href="https://jekyllrb.com/" target="_blank" rel="external nofollow noopener">Jekyll</a> with <a href="https://github.com/alshedivat/al-folio" rel="external nofollow noopener" target="_blank">al-folio</a> theme. Hosted by <a href="https://pages.github.com/" target="_blank" rel="external nofollow noopener">GitHub Pages</a>. Photo by Francesca. Last updated: May 27, 2024. </div> </footer> <script src="/assets/js/bootstrap.bundle.min.js"></script> <script src="https://cdn.jsdelivr.net/npm/mdbootstrap@4.20.0/js/mdb.min.js" integrity="sha256-NdbiivsvWt7VYCt6hYNT3h/th9vSTL4EDWeGs5SN3DA=" crossorigin="anonymous"></script> <script type="text/javascript">function progressBarSetup(){"max"in document.createElement("progress")?(initializeProgressElement(),$(document).on("scroll",function(){progressBar.attr({value:getCurrentScrollPosition()})}),$(window).on("resize",initializeProgressElement)):(resizeProgressBar(),$(document).on("scroll",resizeProgressBar),$(window).on("resize",resizeProgressBar))}function getCurrentScrollPosition(){return $(window).scrollTop()}function initializeProgressElement(){let e=$("#navbar").outerHeight(!0);$("body").css({"padding-top":e}),$("progress-container").css({"padding-top":e}),progressBar.css({top:e}),progressBar.attr({max:getDistanceToScroll(),value:getCurrentScrollPosition()})}function getDistanceToScroll(){return $(document).height()-$(window).height()}function resizeProgressBar(){progressBar.css({width:getWidthPercentage()+"%"})}function getWidthPercentage(){return getCurrentScrollPosition()/getDistanceToScroll()*100}const progressBar=$("#progress");window.onload=function(){setTimeout(progressBarSetup,50)};</script> </body> </html>